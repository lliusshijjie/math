# 概率论模块扩展规划

## 目录结构扩展

```
include/math/
├── core/
│   └── special.hpp          # 新增：特殊函数（gamma, beta, erf等）
├── probability/             # 新增模块
│   ├── distributions.hpp    # 概率分布（PDF/CDF）
│   └── statistics.hpp       # 统计计算
```

---

## 模块设计

### 1. 特殊函数 (`core/special.hpp`)

概率分布依赖的数学基础函数：

| 函数 | 用途 |
|------|------|
| `gamma(x)` | 伽马函数 $\Gamma(x)$ |
| `lgamma(x)` | 对数伽马函数（避免溢出） |
| `beta(a, b)` | 贝塔函数 $B(a,b) = \Gamma(a)\Gamma(b)/\Gamma(a+b)$ |
| `erf(x)` | 误差函数（正态分布CDF核心） |
| `incomplete_gamma(a, x)` | 不完全伽马函数（卡方/伽马CDF） |
| `incomplete_beta(a, b, x)` | 不完全贝塔函数（t/F分布CDF） |

### 2. 概率分布 (`probability/distributions.hpp`)

统一接口设计：
```cpp
template <typename T>
struct DistributionName {
    // 参数成员
    static T pdf(T x, params...);  // 概率密度/质量函数
    static T cdf(T x, params...);  // 累积分布函数
    static T quantile(T p, params...);  // 分位数函数（可选）
};
```

**支持的分布**：

| 类型 | 分布 | 参数 |
|------|------|------|
| 连续 | Uniform | $a, b$ |
| 连续 | Normal | $\mu, \sigma$ |
| 连续 | Exponential | $\lambda$ |
| 连续 | Gamma | $\alpha, \beta$ |
| 连续 | StudentT | $\nu$ (自由度) |
| 连续 | ChiSquared | $k$ (自由度) |
| 连续 | FDistribution | $d_1, d_2$ |
| 离散 | Binomial | $n, p$ |
| 离散 | Poisson | $\lambda$ |

### 3. 统计计算 (`probability/statistics.hpp`)

**描述统计**（支持迭代器范围输入）：
- `mean(begin, end)` - 均值
- `variance(begin, end)` - 方差（样本方差，除以n-1）
- `stddev(begin, end)` - 标准差
- `median(begin, end)` - 中位数
- `quantile(begin, end, p)` - p分位数

**相关分析**：
- `covariance(x_begin, x_end, y_begin)` - 协方差
- `correlation(x_begin, x_end, y_begin)` - Pearson相关系数

**线性回归**：
```cpp
template <typename T>
struct LinearRegressionResult {
    T slope;      // 斜率
    T intercept;  // 截距
    T r_squared;  // 决定系数 R²
};

template <typename T, typename Iter>
LinearRegressionResult<T> linear_regression(Iter x_begin, Iter x_end, Iter y_begin);
```

---

## 实现优先级

```
1. core/special.hpp（gamma, erf等基础函数）
2. 连续分布（Normal → Uniform → Exponential → Gamma）
3. 离散分布（Binomial → Poisson）
4. 高级分布（StudentT → ChiSquared → F）
5. 描述统计函数
6. 相关分析与线性回归
```

---

## 依赖关系

```
Normal     ← erf
Gamma      ← gamma, incomplete_gamma
StudentT   ← gamma, incomplete_beta
ChiSquared ← incomplete_gamma（Gamma分布特例）
F          ← incomplete_beta
Binomial   ← lgamma（用于组合数计算）
```

---

## 
